---
title: "IE360 HW2"
author: "Göksel Bilici"
date: "16.12.2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# INTRODUCTION

   When we think about [welfare](https://en.wikipedia.org/wiki/Welfare) and [cost of living](https://en.wikipedia.org/wiki/Cost_of_living) type of things, maybe one of the most important factor to look at is the CPI, consumer price index. Because it is calculated by taking price changes for each item in the predetermined [basket of goods](https://www.investopedia.com/terms/b/basket_of_goods.asp) and averaging them.
  
  In Turkey, especially in the last years, the price of food, electronic and many more things almost always increased. And that can be explained by a lot of variable, like overall production, country policies, foreign relationship, the trust Turkey gives to investors and traders etc. But when we think about it like there is a connection between price increases and USA Dollar exchange rates over Turkish Lira's. Whenever there is a high increase in the exchange rate, one or two months later we feel there is a price increase in the products we consume. That is seen especially in electronic and technological products and probably one of the reasons for that is because these products come from abroad and international traders use USD in exchange of their products.
  
  When an imports take place , consumers either have the ability to choose between domestic products and nondomestic ones or they have to buy the nondomestic ones to satisfy their needs.When a country's traders use more and more of their money to buy product outside the country meaning when their is an increasing amount of imports in the country's market, comsumers tend to or have to buy more nondomestic products. Therefore, country's own amount of money in the global market increase which may result in higher [inflation](https://www.investopedia.com/terms/i/inflation.asp), which may cause the price of products to increase. Therefore, it is  expected that the more a country use it own money  to import goods the more CPI.

  Therefore, in short we will investigate **"Is there any relation or if there is, how much do USD exchange rate and imports relate to CPI?"**, apart from our feelings. To do that we will look at the data from January of 2008 to September 2020, and it is important to note that the base year for CPI is 2003 for our data, meaning in 2003's first months CPI~100.
  

# DATA MANIPULATION and VISUALIZATION

## The Data

```{r message=FALSE,warning=FALSE}

library("xlsx")
library("ggplot2")
library("lubridate")
library("corrgram")
library("GGally")
library("dplyr")

```


```{r message=FALSE,warning=FALSE}
# import data
theData <- read.xlsx("D:/AILEvs/EZ/EGITIM/AAAA_EE_4.YIL/IE_360/HW2/CPI_Dollar_Import_Data.xls", sheetIndex=1)
# making sure to get data without error
theData <- theData[1:154,1:4]
```

```{r message=FALSE, warning=FALSE}
# Calculate imports in terms of TL
theData <- theData %>%
  mutate(Imports = Imports *Dollar)
```

```{r message=FALSE, warning=FALSE}
# our data structure
str(theData)
```


```{r message=FALSE, warning=FALSE}
head(theData)
```


Before dive into detail of relation analysis of our data, let's look at them separately and analyze how they change throughout time.

### CPI

```{r message = FALSE, warning = FALSE}
ggplot(theData, aes(Date , CPI))+
  geom_line(color = "red", size = 1.2)+
  scale_y_continuous(breaks = seq(100, 500, by = 50))+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  labs(title = "CPI from 2008 to 2020",
       caption = "Source: EVDS")+
  theme(rect = element_rect(fill = "turquoise"),
        plot.title = element_text(color = "black", size = 15, face = "bold", hjust = 0.5),
        axis.text  =element_text(color = "purple")
  )
```
```{r message = FALSE, warning = FALSE}
ggplot(theData, aes(Date , CPI))+
  geom_boxplot(aes(fill= factor(year(Date))))+
  scale_y_continuous(breaks = seq(150, 500, by = 50))+
  labs(title = "CPI from 2008 to 2020",
       caption = "Source: EVDS",
       fill = "Years")+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  theme(rect = element_rect(fill = "turquoise"),
        plot.title = element_text(color = "black", size = 15, face = "bold", hjust = 0.5),
        axis.text  =element_text(color = "purple")
  )
```


### USD Exchange Rates
```{r message = FALSE, warning = FALSE}
ggplot(theData, aes(Date , Dollar))+
  geom_line(color = "blue", size = 1.2)+
  scale_y_continuous(breaks = seq(1, 10, by = 1))+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  labs(title = "Dollar Exchange Rate from 2008 to 2020",
       caption = "Source: EVDS")+
  theme(rect = element_rect(fill = "#00FA9A"),
        plot.title = element_text(color = "black", size = 15, face = "bold", hjust = 0.5),
        axis.text  =element_text(color = "brown")
  )
```
```{r message = FALSE, warning = FALSE}
ggplot(theData, aes(Date , Dollar))+
  geom_boxplot(aes(fill= factor(year(Date))))+
  scale_y_continuous(breaks = seq(1, 10, by = 1))+
  labs(title = "Dollar Exchange Rate from 2008 to 2020",
       caption = "Source: EVDS",
       fill = "Years")+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  theme(rect = element_rect(fill = "#00FA9A"),
        plot.title = element_text(color = "black", size = 15, face = "bold", hjust = 0.5),
        axis.text  =element_text(color = "brown")
  )
```


### Imports
```{r message = FALSE, warning = FALSE}
ggplot(theData, aes(Date , Imports))+
  geom_line(color = "green", size = 1.2)+
  scale_y_continuous(breaks = seq(10000, 150000, by = 10000))+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  labs(title = "Imports from 2008 to 2020",
       caption = "Source: EVDS")+
  theme(rect = element_rect(fill = "yellow"),
        plot.title = element_text(color = "black", size = 15, face = "bold", hjust = 0.5),
        axis.text  =element_text(color = "red")
  )
```
```{r message = FALSE, warning = FALSE}
ggplot(theData, aes(Date , Imports))+
  geom_boxplot(aes(fill= factor(year(Date))))+
  scale_y_continuous(breaks = seq(10000, 150000, by = 10000))+
  labs(title = "Imports from 2008 to 2020",
       caption = "Source: EVDS",
       fill = "Years")+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  theme(rect = element_rect(fill = "yellow"),
        plot.title = element_text(color = "black", size = 15, face = "bold", hjust = 0.5),
        axis.text  =element_text(color = "red")
  )
```


## Correlation Analysis
```{r message = FALSE, warning = FALSE}
theCorrelation <- cor(theData[,2:4])
theCorrelation
```
```{r message = FALSE, warning = FALSE}
corrgram(theCorrelation, order=FALSE, lower.panel=panel.shade,
         upper.panel=panel.pie, text.panel=panel.txt,
         main="Correlation of CPI, Dollar and Imports Data ")
```
```{r message = FALSE, warning = FALSE}
ggpairs(theData[,2:4]) +
  labs(title ="Scatter Plots of CPI, Dollar and Imports between 01.2008 to 10.2020")+
  theme(rect = element_rect(fill = "#E0FFFF"),
        plot.title = element_text(color = "black", size = 15, face = "bold", hjust = 0.5),
        axis.text  =element_text(color = "red")
  )
```


### CPI and Exchange Rates Relations
```{r message = FALSE, warning = FALSE}
cor.test(theData$CPI, theData$Dollar)
```
```{r message = FALSE, warning = FALSE}
ggplot(theData, aes(Date))+
  geom_line(aes(y = CPI),color = "red", size = 1.2)+
  geom_line(aes(y = Dollar*40 + 100),color = "blue", size = 1.2)+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  scale_y_continuous(breaks = seq(100, 500, by = 50),
                     sec.axis = sec_axis(trans=~./40 - 2.5, name = "Dollar Exchange Rate",breaks = seq(1, 10, by = 1)))+
  labs(title = "CPI and Dollar over time")+
  theme(axis.title.y = element_text(color = "red", size=13),
        axis.title.y.right = element_text(color = "blue", size=13),
        plot.title = element_text(size = 15, face = "bold", hjust = 0.5)
  )
```


### CPI and Imports Relations
```{r message= FALSE, warning = FALSE}
cor.test(theData$CPI, theData$Imports)
```

```{r message= FALSE, warning = FALSE}
ggplot(theData, aes(Date))+
  geom_line(aes(y = CPI),color = "red", size = 1.2)+
  geom_line(aes(y = Imports/350 + 71.43),color = "green", size = 1.2)+
  scale_x_date(date_breaks = "1 year", date_labels =  "%Y")+
  scale_y_continuous(breaks = seq(100, 500, by = 50),
                     sec.axis = sec_axis(trans=~.*350-25000, name = "Imports",breaks = seq(10000, 150000, by = 10000)))+
  labs(title = "CPI and Imports over time")+
  theme(axis.title.y = element_text(color = "red", size=13),
        axis.title.y.right = element_text(color = "green", size=13),
        plot.title = element_text(size = 15, face = "bold", hjust = 0.5)
  )
```

# CONCLUSION

# REFERENCES
+ [Electronic Data Delivery System, Central Bank of Turkey](https://evds2.tcmb.gov.tr/)
+ [Wikipedia](https://www.wikipedia.org/)
+ [Investopedia](https://www.investopedia.com/)

# Appendices
+ [Here](Göksel-Bilici_HW2.Rmd) is the markdown file.
